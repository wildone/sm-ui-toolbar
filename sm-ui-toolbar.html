<html><head><meta charset="UTF-8"><link rel="import" href="../sm-ui-button/sm-ui-button.html"><link rel="import" href="../sm-ui-core/sm-ui-core.html"><link rel="import" href="../polymer/polymer.html"></head><body><dom-module id="sm-ui-toolbar">
  <template>
    <style include="sm-css-shady"></style>
    <style include="sm-css"></style>
    <style>:root{--icon-size:14px}:host{@apply(--typography);background:#fff;position:absolute;display:none;box-shadow:0 1px 1px var(--light-black);border-radius:var(--border-radius);overflow:hidden;z-index:var(--on-top)}:host([active]){display:-webkit-box;display:-ms-flexbox;display:flex}.tool{width:var(--tool-size);-ms-flex-negative:0;flex-shrink:0;color:var(--blue)}.tool[disabled]{pointer-events:none;color:var(--gray)}.tool::after{content:'';position:absolute;left:0;right:0;bottom:0;height:3px;background:var(--blue);display:none}.tool[active]::after{display:block}.link{position:relative;width:0;overflow:hidden}.link__input{position:absolute;width:100%;height:100%;padding-right:var(--tool-size);padding-left:8px;color:var(--textColor)}.link__clear{position:absolute;right:0;width:var(--tool-size);color:var(--gray)}.link__clear:hover{color:red!important}</style>

    
    
    <template is="dom-repeat" id="tools" items="[[commands]]" observe="use" filter="_usingCommand">
      <button is="sm-ui-button" id="[[item.name]]" class="tool" icon="simpla:[[item.icon]]" on-tap="_handleToolTap" active="[[item.active]]" disabled$="[[!item.enabled]]">
      </button>
    </template>

    <template is="dom-if" if="[[_usingLink]]">
      <div class="link">
        <input class="link__input" type="text" name="link" value="{{_currentHref::input}}" on-keyup="_checkForEnter" placeholder="Type or paste a link">
        <button is="sm-ui-button" on-tap="_clearAndCloseLink" class="link__clear" icon="simpla:cross"></button>
      </div>
    </template>

  </template>
  <script>!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(2),s=i(a),c=n(4),u=i(c),l=n(5),f=i(l),d=n(6),p=i(d),h=n(7),g=i(h),m=n(8),v=i(m),_=[p.default,g.default,v.default],y=function(){function e(){o(this,e)}return r(e,[{key:"beforeRegister",value:function(){this.is="sm-ui-toolbar",this.properties={range:Object,scribe:Object,active:{type:Boolean,reflectToAttribute:!0,notify:!0,value:!1}},this.observers=["_loadPlugins(scribe)","_watchForRange(scribe)","_watchForActive(scribe)","_toggleWindowListener(active)"],this.listeners={click:"_protectClick"}}},{key:"use",value:function(e){var t=this;e.on("select",function(){t.scribe=e,t.active=!0}),e.on("deselect",function(){return t.active=!1}),_.forEach(function(t){return e.use(t)}),e.on("selectionchange",function(e){e&&e.range&&(t.range=e.range)})}},{key:"_loadPlugins",value:function(e){}},{key:"_watchForRange",value:function(e){}},{key:"_watchForActive",value:function(e){}},{key:"_toggleWindowListener",value:function(e){var t=this;e?(this._windowListener=function(e){e._protected||(t.active=!1)},window.addEventListener("click",this._windowListener)):this._windowListener&&(window.removeEventListener("click",this._windowListener),this._windowListener=null)}},{key:"_protectClick",value:function(e){e._protected=!0}},{key:"behaviors",get:function(){return[].concat(s.default,u.default,f.default)}}]),e}();Polymer(y);var b=document.createElement("sm-ui-toolbar"),k=document.createElement("sm-utility-share");k.type="singletons",k.key="toolbar",k.value=b,document.body?document.body.appendChild(b):document.addEventListener("readystatechange",function(){document.body&&document.body.appendChild(b)})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=i(o),a=["bold","italic","underline","createLink"],s=["bold","italic","underline"],c="A",u=13,l=function(e){switch(e){case"createLink":return"link";default:return e}},f=function(e){return{name:e,enabled:!0,active:!1,use:!0,icon:l(e)}},d=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},p=function(e){var t=new e.api.Selection,n=t.getContaining(function(e){return e.nodeName===c});return n};t.default=[(0,r.default)("_linkOpen"),{properties:{commands:{type:Array,value:function(){return a.map(f)}},_usingLink:{type:Boolean,computed:"_computeUsingLink(commands.*)"},_linkOpen:Boolean,_currentHref:{type:String,value:""}},observers:["_watchCommandStatus(scribe, commands)","_checkUsedCommands(scribe, commands)","_clearLink(scribe)","_manageLink(_linkOpen)","_closeLink(active, _linkOpen)"],execute:function(e,t){var n=!this.active,i=this.scribe,o=new i.api.Selection,r=void 0;i&&(r=i.getCommand(e),i.el.focus(),this.range!==o.range&&(o.selection.removeAllRanges(),o.selection.addRange(this.range)),r.execute(t),n&&(i.el.blur(),o.selection.removeAllRanges(),this.range!==o.range&&o.selection.addRange(o.range)))},_executeCreateLink:function(){this._linkOpen=!this._linkOpen},_usingCommand:function(e){return e.use},_handleToolTap:function(e){var t=e.currentTarget,n=t.id;s.indexOf(n)!==-1?this.execute(n):this["_execute"+d(n)]()},_watchCommandStatus:function(e,t){var n=this,i=function(){t.map(function(t){var n=t.name;return e.getCommand(n)}).filter(function(e){return e&&e.queryState&&e.queryEnabled}).forEach(function(e,t){var i=e.queryState(),o=e.queryEnabled();n.set("commands."+t+".active",i),n.set("commands."+t+".enabled",o)})};["selectionchange","content-changed"].forEach(function(t){return e.on(t,i)})},_checkUsedCommands:function(e,t){var n=this,i=function(t){var n=t.name;return!e._smEnabled||e._smEnabled.indexOf(n)!==-1},o=function(e,t){return n.set("commands."+t+".use",e)};t.map(i).forEach(o)},_computeUsingLink:function(){return this.commands&&this.commands.some(function(e){var t=e.name,n=e.use;return"createLink"===t&&n})},_manageLink:function(e){var t=this.scribe,n=void 0;if(t)if(n=p(t),e)this._currentHref=n?n.href:"",this._prePromptRange=this.range;else if(""===this._currentHref.trim())this.execute("unlink");else{var i=this.range;this.range=this._prePromptRange,this.execute("createLink",this._currentHref),this._clearLink(),this.range=i}},_checkForEnter:function(e){e.keyCode===u&&(this._linkOpen=!1)},_clearLink:function(){this._currentHref=""},_clearAndCloseLink:function(){this._clearLink(),this._linkOpen=!1},_closeLink:function(e,t){!e&&t&&(this._linkOpen=!1)}}]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{observers:["_handleLinkOpen("+e+")"],get _linkAnimations(){var e=[].slice.call(Polymer.dom(this.root).querySelectorAll(i)),t=this.$$(o),n=e[0].offsetWidth*(e.length-1);return{tools:{target:e[0],frames:[{marginLeft:0},{marginLeft:"-"+(n+"px")}]},input:{target:t,frames:[{width:0},{width:a}]}}},_toggleLinkPrompt:function(e){var t=this._linkAnimations,n=t.tools,i=t.input,o=this.$$(r),a=void 0;"open"===e?(n.target.animate(n.frames,s),a=i.target.animate(i.frames,s),a.onfinish=function(){return o.focus()}):(n.target.animate(n.frames.reverse(),s),i.target.animate(i.frames.reverse(),s))},_handleLinkOpen:function(e){this._toggleLinkPrompt(e?"open":"close")}}};var n=simpla._constants.easings,i=".tool",o=".link",r=".link__input",a="280px",s={easing:n.easeOutCubic,fill:"both",duration:180}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="flex",i="50%",o=8,r=8;t.default={properties:{position:{type:Object,value:function(){return{top:0,left:0,offsetLeft:0,offsetTop:0}}}},observers:["_positionChanged(position.left, position.top)","_offsetsChanged(position.offsetLeft, position.offsetTop)","_updateOffsets(range)","_rangeChanged(range)"],get _translateX(){return"calc(-"+i+" + "+this.position.offsetLeft+"px)"},get _translateY(){return"calc("+this.position.offsetTop+"px)"},_positionChanged:function(e,t){this.style.left=e+"px",this.style.top=t+"px"},_offsetsChanged:function(){var e="translate("+this._translateX+", "+this._translateY+")";this.style.transform=e,this.style.webkitTransform=e,this.style.msTransform=e},_updateOffsets:function(e){var t=this,i=0,a=0,s=void 0,c={},u=void 0,l=void 0;if(e.getBoundingClientRect){var f=function(){var e=t.style.display,i=void 0;return t.style.display=n,i=window.getComputedStyle(t),u=parseFloat(i.height),l=parseFloat(i.width),t.style.display=e,{height:u,width:l}}();u=f.height,l=f.width;var d=function(){var t=e.getBoundingClientRect(),n=t.left+t.width/2,i={};return i.left=n-l/2,i.right=n+l/2,i.top=t.top-u,{edges:i,rangeMiddle:n,rangeHeight:t.height}}();c=d.edges,s=d.rangeHeight,c.left<0&&(i=-(c.left-o)),c.right>window.innerWidth&&(i=-(c.right-window.innerWidth+o)),a=c.top<0?s<u?s+r:0:-(u+r),this.set("position.offsetLeft",i),this.set("position.offsetTop",a)}},_rangeChanged:function(e){var t=void 0,n=void 0,i=void 0,o=void 0,r=void 0;if(e.getBoundingClientRect){if(e.collapsed)return void(this.active=!1);t=e.getBoundingClientRect(),n=window.pageYOffset,i=window.pageXOffset,r=t.top,o=t.left+t.width/2,this.set("position.top",r+n),this.set("position.left",o+i)}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={attached:function(){var e=this,t=function(t){t?e.removeAttribute("hidden"):e.setAttribute("hidden","")};this._unobserveEditing=Simpla.observe("editing",t),t(Simpla.getState().editing)},detached:function(){this._unobserveEditing()}}},function(e,t){"use strict";function n(e,t,n){var i=void 0;return function(){for(var o=arguments.length,r=Array(o),a=0;a<o;a++)r[a]=arguments[a];var s=this,c=function(){i=null,n||e.apply(s,r)},u=n&&!i;clearTimeout(i),i=setTimeout(c,t),u&&e.apply(s,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t){var n=new e.api.Selection,i=[n],o=n.range?"select":"deselect";e.trigger(o,i),e.trigger("selectionchange",i)}var i=n(t,10),o=["keyup","mouseup","focus","blur"];o.forEach(function(t){return e.el.addEventListener(t,i)})}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=new e.api.Command("createLink");t.nodeName=n,t.execute=function(t){var n=this,i=new e.api.Selection,o=i.range,r=i.getContaining(function(e){return e.nodeName===n.nodeName});r&&(o.selectNode(r),i.selection.removeAllRanges(),i.selection.addRange(o)),e.api.SimpleCommand.prototype.execute.call(this,t)},t.queryState=function(){var t=this,n=new e.api.Selection;return!!n.getContaining(function(e){return e.nodeName===t.nodeName})},e.commands.createLink=t};var n="A"},function(e,t,n){var i,o;i=[],o=function(){"use strict";return function(){return function(e){var t=e.element,n=new e.api.Command("unlink");n.execute=function(){var n=new e.api.Selection;n.selection.isCollapsed?e.transactionManager.run(function(){var e=n.getContaining(function(e){return"A"===e.nodeName});e&&(n.placeMarkers(),t.unwrap(e.parentNode,e),n.selectMarkers())}):e.api.Command.prototype.execute.apply(this,arguments)},n.queryEnabled=function(){var t=new e.api.Selection;return t.selection.isCollapsed?!!t.getContaining(function(e){return"A"===e.nodeName}):e.api.Command.prototype.queryEnabled.apply(this,arguments)},e.commands.unlink=n}}}.apply(t,i),!(void 0!==o&&(e.exports=o))}]);</script>
</dom-module>
</body></html>